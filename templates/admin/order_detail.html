<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Order {{ order.order_code }}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
<h3>Order Details - {{ order.order_code }}</h3>
<p><strong>Status:</strong> {{ order.order_status }} | <strong>Payment:</strong> {{ order.payment_mode }}</p>

<form method="POST" action="/admin/order/update_status/{{ order.order_code }}" class="mb-3">
  <label>Update Status</label>
  <select name="order_status" class="form-select mb-2" required>
    <option value="Pending" {% if order.order_status == 'Pending' %}selected{% endif %}>Pending</option>
    <option value="Shipped" {% if order.order_status == 'Shipped' %}selected{% endif %}>Shipped</option>
    <option value="Delivered" {% if order.order_status == 'Delivered' %}selected{% endif %}>Delivered</option>
    <option value="Cancelled" {% if order.order_status == 'Cancelled' %}selected{% endif %}>Cancelled</option>
    <option value="Refunded" {% if order.order_status == 'Refunded' %}selected{% endif %}>Refunded</option>
  </select>
  <textarea name="admin_comment" class="form-control mb-2" placeholder="Add comment...">{{ order.admin_comment }}</textarea>
  <button class="btn btn-success btn-sm">Update Status</button>
</form>

{% if order.order_status == 'Paid' %}
<form method="POST" action="/admin/refund/{{ order.order_code }}">
  <button class="btn btn-warning btn-sm">ğŸ’¸ Process Refund</button>
</form>
{% elif order.refund_state != 'Not Requested' %}
<p><strong>Refund ID:</strong> {{ order.refund_id }}</p>
<p><strong>Refund Status:</strong> {{ order.refund_state }}</p>
<a href="/admin/refund_status/{{ order.refund_id }}" class="btn btn-outline-info btn-sm">ğŸ”„ Check Refund Status</a>
{% endif %}


<hr>

<h5>Items</h5>
<table class="table table-sm table-bordered">
  <thead>
    <tr>
      <th>Product</th>
      <th>Qty</th>
      <th>Price</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
  {% for item in items %}
    <tr>
      <td>{{ item.product_name }}</td>
      <td>{{ item.quantity }}</td>
      <td>â‚¹{{ item.price }}</td>
      <td>â‚¹{{ item.total }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<a href="/admin/orders" class="btn btn-secondary mt-3">â† Back to Orders</a>
</body>
</html>
